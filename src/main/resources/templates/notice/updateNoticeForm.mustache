{{>/layout/header}}
<form action="/notice/updateNotice" method="post" enctype="multipart/form-data">
    <div class="main-container" style="display: flex; flex-direction: column;">
        <div style="margin-left: 50px; margin-right: 50px;">
            <div style="display: flex; flex-direction: row;  margin: 20px; ">
                <div style="margin-right: 20px;">공고 공개여부</div>
                <input type="radio" id="on" name="open" value="on">
                <label for="on">공개</label>
                <input type="radio" id="off" name="open" value="off" style="margin-left: 50px;">
                <label for="off">비공개</label>
            </div>
            <br>
            <div style="display: flex; flex-direction: row;">
                <div style="display: flex; flex-direction: column;">
                    <img class="box" src="/upload/{{notice.userImg}}"
                        style="width: 20%; height: 200px; width: 200px; margin-bottom: 20px; border-radius: 50%; "
                        id="preview">
                    </img>
                    <input type="file" name="userImg" style="margin-left: 70px;" onchange="changePic(event)">
                </div>
                <div>
                    <div>
                        <div class="box" style="margin-left: 80px;">
                            <div style="display: flex; flex-direction: row; ">
                                <textarea class="input-box" id="myTextarea" rows="1" maxlength="200" name="semiTitle"
                                    placeholder="공고의 제목을 입력해주세요" style="height: 30px; width: 600px; resize: none;"
                                    onkeydown="preventEnterKey(event)">{{notice.semiTitle}}</textarea>
                            </div>
                            <hr class="line" style="margin: 0;">
                            <br>
                            <div style="display: flex; flex-direction: row; align-items: center;">
                                <textarea class="input-box" id="myTextarea" name="semiContent" rows="4" maxlength="200"
                                    placeholder="간단한 기업소개글 입력해주세요."
                                    style="margin:0; width: 600px; height: 120px; resize: none;"
                                    onkeydown="preventEnterKey(event)">{{notice.semiContent}}</textarea>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <div style="font-weight: bold; font-size: 30px; margin-left: 80px; margin-top: 50px;">
            지원자격 상세</div>
        <hr class="line" style="margin-top: 10px; margin-left: 80px; margin-right: 80px;">
        <div style="float: left;">
            <div class="box-invisible" style="display: flex; flex-direction: row; ">
                <div class="box-invisible" style="width: 50%; display: flex; flex-direction: row;  margin-left: 50px;">
                    <div class="box-invisible"
                        style="width: fit-content; margin-left: 30px; margin-right: 10px; font-weight: bold; font-size: 20px; align-self: center;">
                        채용분야
                    </div>
                    <div class="box-invisible" style="width: fit-content; margin-left: 0;">
                       
                        <input class="input-box" type="text" name="workField" placeholder={{notice.workField}}>
                    </div>
                </div>
            </div>
            <div class="box-invisible" style="display: flex; flex-direction: row;">
                <div class="box-invisible" style="width: 50%; display: flex; flex-direction: row;  margin-left: 50px;">
                    <div class="box-invisible"
                        style="width: fit-content; margin-left: 30px; margin-right: 10px; font-weight: bold; font-size: 20px; align-self: center;">
                        기업명
                    </div>
                    <div class="box-invisible" style="width: fit-content; margin-left: 0;">
                        <input class="input-box" type="text" name="bizName" placeholder={{notice.bizName}}
                            style=" margin-left: 0;">
                    </div>
                </div>
            </div>
            <div class="box-invisible" style="display: flex; flex-direction: row;">
                <div class="box-invisible" style="width: 50%; display: flex; flex-direction: row;  margin-left: 50px;">
                    <div class="box-invisible"
                        style="width: fit-content; margin-left: 30px; margin-right: 10px; font-weight: bold; font-size: 20px;">
                        근무 지역</div>
                    <select class="box" data-bs-toggle="dropdown" name="address" values="근무지 선택"
                        style="width: 100px; margin-left: 0px;">근무지역 선택</button>
                        <ul>
                            <li>
                                <option value="{{notice.address}}">{{notice.address}}</option>
                            </li>
                            <li>
                                <option value="미국">미국</option>
                            </li>
                            <li>
                                <option value="서울">서울</option>
                            </li>
                            <li>
                                <option value="경기">경기</option>
                            </li>
                            <li>
                                <option value="부산">부산</option>
                            </li>
                            <li>
                                <option value="대전">대전</option>
                            </li>
                        </ul>
                    </select>
                    <select class="box" data-bs-toggle="dropdown" name="address2" values="근무지 선택"
                        style="width: 100px; margin-left: 0px;">근무지역 선택</button>
                        <ul>
                            <li>
                                <option value="{{notice.address2}}">{{notice.address2}}</option>
                            </li>
                            <li>
                                <option value="뉴욕">뉴욕</option>
                            </li>
                            <li>
                                <option value="용산">용산</option>
                            </li>
                            <li>
                                <option value="용인">용인</option>
                            </li>
                            <li>
                                <option value="서면">서면</option>
                            </li>
                            <li>
                                <option value="성심당">성심당</option>
                            </li>
                        </ul>
                    </select>
                </div>
            </div>
            <div class="box-invisible" style="display: flex; flex-direction: row;">
                <div class="box-invisible" style="width: 50%; display: flex; flex-direction: row;  margin-left: 50px;">
                    <div class="box-invisible"
                        style="width: fit-content; margin-left: 30px; margin-right: 10px; font-weight: bold; font-size: 20px;">
                        요구 경력</div>
                    <select class="box" data-bs-toggle="dropdown" name="career" values="경력 선택"
                        style="width: 100px; margin-left: 0px;">경력 선택</button>
                        <ul>
                            <li>
                                <option value="{{notice.career}}">{{notice.career}}</option>
                            </li>
                            <li>
                                <option value="신입">선택</option>
                            </li>
                            <li>
                                <option value="신입">신입</option>
                            </li>
                            <li>
                                <option value="1~2년">1~2년</option>
                            </li>
                            <li>
                                <option value="3~5년">3~5년</option>
                            </li>
                            <li>
                                <option value="5년 이상">6년 이상</option>
                            </li>
                        </ul>
                    </select>
                </div>
            </div>
            <div class="box-invisible" style="display: flex; flex-direction: row;">
                <div class="box-invisible" style="width: 50%; display: flex; flex-direction: row;  margin-left: 50px;">
                    <div class="box-invisible"
                        style="width: fit-content; margin-left: 30px; margin-right: 10px; font-weight: bold; font-size: 20px;">
                        요구 학력</div>
                    <select class="box" data-bs-toggle="dropdown" name="education" values="경력 선택"
                        style="width: 100px; margin-left: 0px;">학력 선택</button>
                        <ul>
                            <li>
                                <option value="{{notice.education}}">{{notice.education}}</option>
                            </li>
                            <li>
                                <option value="고졸">고등학교졸업 이상</option>
                            </li>
                            <li>
                                <option value="초대졸">초대졸 이상</option>
                            </li>
                            <li>
                                <option value="대졸이상">대졸이상</option>
                            </li>
                            <li>
                                <option value="대학원졸업 이상">대학원졸업 이상</option>
                            </li>
                        </ul>
                    </select>
                </div>
            </div>
        </div>
        <div style="display: flex; margin-left: 100px; margin-top: 30px" ;>
            <div style=" font-weight: bold; font-size: 20px; ">기술스택</div>

            <div style=" display: flex; flex-direction: column; margin-top: 30px;">
                <br>
                {{#techs}}
                <div style=" display: flex; flex-direction: row;">
                    <input type="checkbox" name="tech-notice" value="{{id}}">
                    <div style="margin-right: 10px;">{{techname}}</div>
                </div>
                {{/techs}}
            </div>
        </div>
        <div style="display: flex; flex-direction: column; margin-top: 30px;">
            <div style="font-weight: bold; font-size: 20px;  margin-left: 110px;">자기소개서</div>

            <textarea id="myTextarea" class="box" rows="10" name="mainContent"
                placeholder="자세한 공고내용을 입력해주세요. ex) 회사소개, 주요업무, 자격요건, 우대사항, 혜택 및 복지 등"
                style="width: 1000px; margin-top: 20px; margin-bottom: 20px;">{{notice.mainContent}}</textarea>
        </div>
        <div class="box-invisible" style="display: flex; flex-direction: row;">

            <div class="box-invisible"
                style="width: fit-content; margin-left:90px; margin-right: 10px; font-weight: bold; font-size: 20px;">
                마감일</div>
            <input class="box" type="date" name="deadLine" style="width: 40%; margin-left: 0px;" value={{notice.deadLine}}>
        </div>
        <div class="box-invisible" style="display: flex; justify-content: center;">
            <button class="button" type="submit">작성완료</button>
        </div>
    </div>
    </body>
</form>
<script>
    function changePic(e1) { // 이력서 사진 저장 함수
        // console.log(e1);
        let f = e1.srcElement.files[0];
        // console.log(f);
        if (!f.type.match("image.*")) {
            alert("이미지를 등록해주세요");
            return;
        }
        let reader = new FileReader(); // 버퍼
        reader.onload = function (e2) { // 콜백 함수(내가 실행하는 게 아니라 다른 어떤 이벤트가 끝났을 때 실행되는 함수)
            let previewEl = document.querySelector("#preview");
            previewEl.setAttribute("src", e2.target.result);
        }
        reader.readAsDataURL(f); // 파일 읽기. 이벤트 루프에 등록해놓고 main 빠져나옴(비동기). 다 읽으면 onload()를 실행 ↑
    }
    async function saveTechResume() { // TechResume에 저장하는 함수
        let requestBody = {
            techname: document.querySelector("#techname").value
        };
        console.log(requestBody);
        let response = await fetch("/api/reply/save", { // js오브젝트 타입이므로 {}로 묶음
            method: "post",
            headers: { // post와 put만 body와 content-type을 들고 간다.
                "Content-Type": "application/json"
            },
            body: JSON.stringify(requestBody)
        });
        let responseBody = await response.json();
        console.log(responseBody);
        if (responseBody.success) {
            location.reload(); // ssr
        } else {
            alert(responseBody.data);
        }
    }
</script>
{{>/layout/footer}}